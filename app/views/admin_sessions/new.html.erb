<%= form_tag do %>
	<div id="section_title" class="col-xs-10 col-sm-5 col-md-4 col-lg-4">
		<%= t('log_in') %> 
		<% unless session[:role] == "Admin" %>
		  <div id="login_link"><%= link_to t('user_register'), new_user_path %></div>
		<% end %>
	</div>
	<div id="input_form" class="col-xs-10 col-sm-5 col-md-4 col-lg-4">

    <% if flash[:notice] %>
      <div class="warning warning-success" style="color:rgba(57, 128, 221, 0.87);text-align:center;">
        <%= flash[:notice]  %>
      </div>
    <% end %>

    <% if flash[:alert] %>
      <div class="warning warning-error" style="color:#dd4b39;text-align:center;">
        <%= flash[:alert] %>
      </div>
    <% end %>

		<div class="field">
			<%= label_tag :email, 'Email' %>
			<%= text_field_tag :email, params[:email]%>
		</div>
		<div class="field">
			<%= label_tag :password, t('password') %>
			<%= password_field_tag :password, params[:password] %>
		</div>

		<div class="actions">
			<%= submit_tag "LOGIN" %>
		</div>
	</div>
<% end %>
<script>
$(function() {
  var user_email = $("#email");
  var user_password = $("#password");
  // Functions
  function show_warning(field) {
    field.css("border-color", "#dd4b39"); 
    var warning_label = null;
    if (locale  == "bs")
      warning_label = $("<p></p>").text("Ovo polje ne mo≈æe ostati prazno.");
    else 
      warning_label = $("<p></p>").text("This field can't be empty.");
    warning_label.attr("class","warning");
    warning_label.css("color","#dd4b39");
    field.parent().append(warning_label);
  }
  function remove_warning(field) {
    field.parent().children("p").remove(".warning");
    field.css("border-color", "#b7b7b7");
  }
  function validate_field(field) {
  $(".warning-error").remove();

    var number_of_children = field.parent().children().length;
    if (!field.val()) {
      if(number_of_children == 2) show_warning(field);
    }
    else {
      if (number_of_children > 2) remove_warning(field);
    }

  }
  user_email.blur(function(){
    validate_field($(this));
  });
  user_password.blur(function(){
    validate_field($(this));
  });
  // Onsubmit validation
  $("form").submit(function() {
    var has_empty = false;
    $("#password, #email", this).each(function() {
      if(!$(this).val()) {
        has_empty = true;
        validate_field($(this));      
      }
    });
    if (has_empty)  {
      return false;
    }
    return true;
  });
});
</script>
